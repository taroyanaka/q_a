<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>black paint q_a</title>

<link rel="stylesheet" href="./lib/reset.css">
<script src="./lib/localforage@1.10.0.js"></script>
<script src="./lib/vue@3.2.36.global.prod.js"></script>
<script src="./lib/ramda.@0.28.0.js"></script>
<script src="./lib/shuffle.js"></script>
<script src="./lib/qrcode.js"></script>
<!-- <script src="./lib/my_global_function_for_q_a.js"></script> -->

<!-- <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/vue@3.2.45/dist/vue.global.prod.js"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/ramda/0.28.0/ramda.min.js"></script> -->

<style>
.choose_question{
    font-size: 5rem;
}
.parent_choose{
    display: flex;
    flex-direction: column;
    height: 50vh;
    justify-content: space-around;
}
.choose_button{
    font-size: 5rem;
}
.choose_button_num0{
    display: flex;
    justify-content: center;
    width: 100%;
    height: 33%;
}
.choose_button_num1{
    display: flex;
    justify-content: center;
    width: 100%;
    height: 33%;
}
.choose_button_num2{
    display: flex;
    justify-content: center;
    width: 100%;
    height: 33%;
}

    .prgr_bar{
        /* 線を細くする */
        height: 0.7rem;
        width: calc(100% - 12rem);
        position: fixed;
        bottom: 0;
        left: 0;
        /* margin-top: 0; */
        /* margin-bottom: 0; */
        /* 上部の隙間をなくす */
        /* padding-top: 0; */
        /* padding-bottom: 0; */

    }
    .toggle_sidebar{
        /* toggle_sidebarを常に画面右下に表示 */
        position: fixed;
        bottom: 0;
        right: 0;
        /* wdith 10rem */
        width: 10rem;
        /* height 3rem */
        height: 3rem;
    }
    .column-2-when-display-toggle_sidebar{
        z-index: 20;
        position: fixed;
        top: 0;
        right: 0;
        width: 10rem;
        height: 3rem;
    }

    @keyframes flash {
        0%   {opacity: 1;}
        50%  {opacity: 0;}
        100% {opacity: 1;}
    }

    .flash_incorrect{
        /* 点滅するCSS */
        animation: flash 1s 1;
        /* animation: flash 0.5s infinite; */
    }
    /* not_quiz_sectionをサイドバーで表示/非表示を切り替え */
    .column-1 {
        position: fixed;
        top: 0;
        left: 0;
        width: 5rem;
        height: 100vh;
        background-color: #f1f1f1;
        z-index: 100;
    }
    /* quiz_sectionをnot_quiz_sectionの分横にずらす */
    .column-2 {
        position: relative;
        top: 0;
        left: 5rem;
        width: calc(100% - 5rem);
        height: 100vh;
        /* background-color: #f1f1f1; */
        background-color: gray;
        z-index: 1;
    }
.column-2-when-display-none-column-1 {
        position: relative;
        top: 0;
        left: 0;
        width: calc(100%);
        height: 100vh;
        /* background-color: #f1f1f1; */
        background-color: gray;
        z-index: 1;
}
    .display-none-column-1{
        display: none;
        /* 非表示にして要素が無いものとする */
        width: 0;
        height: 0;
    }

    .disable_temporary{
        display: none;
    }


    .slide_mode_color{
        /* 薄い緑色 */
        background-color: #DDFFDD;
    }
    /* スライドの表示を設定 qは左寄せ, aは右寄せ */
    .q{
        text-align: left;
    }
    .a{
        text-align: right;
    }

    /* 2択最速回答(時間決めてor時間測定) */
    .black-paint-it {
        color: black;
        background-color: black;
    }

.maru_batu, .maru_batu *, .black_paint, .slide_mode_color{
    font-size: 10vw;
    white-space: word-wrap;
}
.parent_full_screen{
    position: relative;
}
.front_of_full_screen{
    z-index: 10;
    position: absolute;
    top: 0;
}
/* back_full_screenとfront_of_full_screenをz-indexで同じ位置に表示する */
.back_full_screen{
    z-index: 1;
    position: absolute;
    top: 0;

    display: flex;
    /* width 100% */
    width: 100%;

    justify-content: space-around;
}
.maru{
    /* display: flex; */
    justify-content: center;
    width: 50%;
    height: 50vh;
}
.batu{
    /* display: flex; */
    justify-content: center;
    width: 50%;
    height: 50vh;
}

</style>


</head>
<body class="app">

<!-- toggle_sidebar()でdisplay-none-column-1で表示/非表示を切り替える -->
<!-- <div class="column-1"> -->
<div :class="column_1_none ? 'display-none-column-1' : 'column-1'">
    <button @click="mode = 'choose'">選択モード</button>
    <button @click="mode = 'maru_batu'">⭕️❎問題モード</button>
    <button @click="mode = 'black_paint'">黒塗りモード</button>
    <button @click="mode = 'slide'">スライドモード</button>
    <button @click="mode = 'qr'">QRコード</button>

    <div class="optional_function">
        <!-- <button @click="reverse_q_a">🔃</button> -->
        <!-- <button @click="exe1(true)">🔃</button> -->
        <button @click="exe1('reverse')">🔃</button>
        <!-- <button @click="shuffle_q_a">🌪️</button> -->
        <button @click="exe1('shuffle')">🌪️</button>
        <button @click="swap_q_a">🔁</button>
        <button @click="save_data_to_all_save">🗂️</button>
    </div>
    <button @click="fn19_0" class="save_opener">📂</button>
    <ul style='display: block' ref="save_data_set_list_parent1">
    <li v-for="(DATAVAL, DATAIDX) in all_save" class="save_data_set_list">
        <span @click="save_data_set(DATAIDX)">{{ [DATAVAL[0].split("\n")[0], DATAVAL[1].split("\n")[0]] }}</span>
        <button @click="save_data_set(DATAIDX)" class="save_data_set">📂</button>
        <button @click="save_data_delete(DATAIDX)" class="save_data_delete">🗑️</button>
    </li>
    </ul>
    <div v-for="(DATA_VAL, DATA_IDX) in textContent_ary_1">
        <div>
            <button @click="set_data_sample_array_obj(DATA_IDX)">{{ file_name_ary[DATA_IDX] }}</button>
        </div>
    </div>
    <div v-for="(DATA_VAL, DATA_IDX) in sample_array_obj">
        <button @click="set_data_sample_array_obj(DATA_IDX)">set_data_sample_array_obj({{ DATA_IDX }})</button>
    </div>

















<button @click="textarea_opener" class="textarea_opener">📝</button>
<div class="textarea-column-1" id="target">
    <textarea name="" id="textarea-column-1-1" rows="30" cols="" v-model="data_a" :style="{ display: textarea_visible ? 'block' : 'none' }"></textarea>
    <textarea name="" id="textarea-column-1-2" rows="30" cols="" v-model="data_b" :style="{ display: textarea_visible ? 'block' : 'none' }"></textarea>
</div>
<div>
    <button @click="fn18" class="result_opener">📖</button>
    <template v-for="(DATAVAL, DATAIDX) in online_data_A">
        <div class="textarea-column-2">
        <div class="a">
            <button @click="fn9(DATAIDX)" class="a-1">↩️</button>
            <button @click="fn16(DATAIDX)" class="a-2">🗑️</button>
            <button @click="fn17(DATAIDX)" class="a-3">📚</button>
        </div>
    <textarea name="" cols="30" rows="10" class="b" style='display: block;' ref="results">{{ DATAVAL[0] }}</textarea>
    <textarea name="" cols="30" rows="10" class="c" style='display: block;' ref="results">{{ DATAVAL[1] }}</textarea>
        </div>
    </template>
</div>
<div v-if="show_textarea">
    <textarea name="" id="" cols="30" rows="10" v-model="data_0"></textarea>
    <textarea name="" id="" cols="30" rows="10" v-model="data_1"></textarea>
</div>

    <!-- <button @click="fn21(1)" class="font_sizing">◉</button>
    <button @click="fn21(-1)" class="font_sizing">⦿</button>
    <button @click="fn21" class="font_sizing">◎</button> -->


</div>

<div :class="column_1_none ? 'column-2-when-display-none-column-1' : 'column-2'">

<div class="quiz_section">
<button @click="toggle_sidebar" :class="column_1_none ? 'toggle_sidebar' : 'column-2-when-display-toggle_sidebar'">Toggle Sidebar</button>





<!-- <div v-if="only_one_q_a_mode === true"> -->
<template v-for="(DATA_VAL, DATA_IDX) in [exe1_data[only_one_q_a_mode_COUNTER]]">
<div v-if="mode === 'maru_batu'" class="maru_batu">
<progress :value="only_one_q_a_mode_COUNTER" :max="exe1_data.length" id="prgr" class="prgr_bar"></progress>
<div v-if="DATA_VAL[3] === false" class="parent_full_screen">
    <div class="front_of_full_screen">
        <span>{{ DATA_VAL[0] }}</span>
        <span> = </span>
        <span>{{ DATA_VAL[1] }}</span>
        <div v-if="maru_batu_result !== '' ">{{ maru_batu_result }}</div>
    </div>
    <div class="back_full_screen">
        <button @click="check_maru_batu(DATA_VAL, DATA_VAL[2][0], 'maru')" :class="flash_incorrect === 'maru' || flash_incorrect === null ? 'flash_incorrect maru' : 'maru'" ref="maru">⭕️</button>
        <button @click="check_maru_batu(DATA_VAL, DATA_VAL[2][1], 'batu')" :class="flash_incorrect === 'batu' || flash_incorrect === null ? 'flash_incorrect batu' : 'batu'" ref="batu">❎</button>
    </div>
</div>
</div>

<div v-if="mode === 'black_paint'" class="black_paint" @click="change_paint_or_raw(DATA_IDX)">

    <progress :value="only_one_q_a_mode_COUNTER" :max="exe1_data[only_one_q_a_mode_COUNTER].length" id="prgr" class="prgr_bar"></progress>

    <div>{{ DATA_VAL[0] }}</div>
    <div :class="DATA_VAL[4] ? 'black-paint-it' : ''">{{ DATA_VAL[1] }}</div>
    <div v-if="paint_result !== '' ">{{ paint_result }}</div>
</div>
</template>
<!-- </div> -->

<div v-if="mode === 'slide'" class="slide_mode_color">
    <progress :value="currentIndex" :max="slides.length" id="prgr" class="prgr_bar"></progress>
    <br>
    <br>
    <br>
    <!-- 現在のスライドを表示 -->
    <!-- <div @click="next_slide">{{ slides[currentIndex] }}</div> -->
    <div v-if="slides.length > 0">
        <div v-if="slides[currentIndex].q" class="q" @click="next_slide">{{ slides[currentIndex].q }}</div>
        <div v-if="slides[currentIndex].a" class="a" @click="next_slide">{{ slides[currentIndex].a }}</div>
    </div>
    <!-- 最初のスライドに -->
    <button @click="first_slide">最初へ</button>
    <!-- 前のスライドに移動するボタン -->
    <button @click="prev_slide">前へ</button>
    <!-- 次のスライドに移動するボタン -->
    <button @click="next_slide">次へ</button>
    <!-- auto slide mode button(auto slide状態の時にクリックするとstop_autoslide) -->
    <div v-if="!auto_slide_mode">
        <button @click="auto_slide">auto slide</button>
            <!-- input numberでtime_intervalを設定 100刻みで変更できて最低値を100とする -->
            <input type="number" v-model="time_interval" min="0.1" step="0.1">秒
    </div>
    <div v-if="auto_slide_mode">
        <button @click="stop_auto_slide">stop auto slide</button>
    </div>
</div>

<div v-if="mode === 'choose'">
    <!-- <template v-for="(DATAVAL, DATAIDX) in " class="simple_mode2"> -->
    <!-- <template v-for="(DATAVAL, DATAIDX) in [hoge_ary[only_one_q_a_mode_COUNTER]]" class="simple_mode2"> -->
    <!-- <template v-for="(DATAVAL, DATAIDX) in [exe1_data[only_one_q_a_mode_COUNTER]]" class="simple_mode2"> -->
    <template v-for="(DATAVAL, DATAIDX) in [hoge_ary[only_one_q_a_mode_COUNTER]]" class="simple_mode2">
    <div class="parent_choose" v-if="only_one_q_a_mode ? DATAIDX === current_index : true">
        <span class="choose_question">{{ DATAVAL[2] }} {{ DATAVAL[3] }}</span>
        <!-- <span class="" @click="q_a_fn20(DATAIDX)">{{ q_a_data5[DATAIDX] }}</span> -->
        <button :class="'choose_button choose_button_num' + item_idx" v-for="(item, item_idx) in DATAVAL[1]" @click="q_a_fn3(DATAVAL[0], item)">{{ item }}</button>
    </div>
    </template>
    <!-- <button @click="q_a_change_current_index(+1)" class="check_button" v-if="only_one_q_a_mode">⬇️</button> -->
    <!-- <button @click="q_a_fn4" class="check_button">🎮</button> -->
</div>


<div v-if="mode === 'qr'">
<!-- <div id="qrcode" ref="qrcode"></div> -->
<button @click="show_qr">show_qr</button>
<div ref="qrcode"></div>
</div>





</div>





</div>













</body>



<script>
const app = Vue.createApp({
data() {
return {
hoge_ary: [],
paint_result: '',
maru_batu_result: '',
flash_incorrect: '',

only_one_q_a_mode: true,
only_one_q_a_mode_COUNTER: 0,


column_1_none: true,

slides: [],
currentIndex: 0,
auto_slide_mode: false,
time_interval: 0.5,
// mode: 'maru_batu',
// mode: 'black_paint',
// mode: 'slide',
mode: 'choose',
// mode: 'qr',

file_name_ary: [],
textContent_ary_1: [],
textContent_ary_2: [],
exe1_data: [],
data_0: `aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
ccccccccccccccccccccccccccccccccccc
ddddddddddddddddddddddddddddddddddddddddddddd
eeeeeeeeeeeeeeeeeeeeeeee`,
data_1: `AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD
EEEEEEEEEEEEEEEEEEEEEEEE`,
sample_array_obj: [],













all_save: [],
split_data_b: [],
data_b: '',
q_a_data5: [],
data_a: '',
online_data_A: [],
test_mode: false,


current_index: 0,



textarea_visible: false,
}},
watch: {

data_b: {
    handler() {
    this.q_a_processing();
    },
    deep: true
},
data_a: {
    handler() {
    this.q_a_processing();
    },
    deep: true
},

},
beforeCreate(){},
created(){},
beforeMount(){},
async mounted() {
await this.set_up();

// this.q_a_processing();
this.convertData2ToData1(to_ary(app.exe1_data));
this.save_data_load();
this.toggle_sidebar();

// new QRCode(this.$refs.qrcode, {
//       text: "https://taroyanaka.github.io/q_a/b_p.html",
//       width: 256,
//       height: 256,
//       colorDark : "#000000",
//       colorLight : "#ffffff",
//       correctLevel : QRCode.CorrectLevel.H
// });

},
beforeUpdate() {},
async updated() {},
methods: {
async set_up(){
    const text_url_ary_1 = [
'./asset/txt_dir/sample_ary_1.txt',
'./asset/txt_dir/res_2_ary_1.txt',
        './asset/txt_dir/res_2_2_ary_1.txt',
        // './asset/txt_dir/res_3_ary_1.txt',
        // './asset/txt_dir/res_4_ary_1.txt',
        // './asset/txt_dir/res_5_ary_1.txt',
    ];
    const text_url_ary_2 = [
'./asset/txt_dir/sample_ary_3.txt',
'./asset/txt_dir/res_2_ary_3.txt',
        './asset/txt_dir/res_2_2_ary_3.txt',
        // './asset/txt_dir/res_3_ary_3.txt',
        // './asset/txt_dir/res_4_ary_3.txt',
        // './asset/txt_dir/res_5_ary_3.txt',
    ];
    const global_file_name_ary = [
    'サンプル問題集5問',
        '英検2級',
        '英検準2級',
        // '英検3級',
        // '英検4級',
        // '英検5級',
    ];
    this.file_name_ary = global_file_name_ary;
    for(let i = 0; i < text_url_ary_1.length; i++){
        const response = await fetch(text_url_ary_1[i]);
        this.textContent_ary_1.push(await response.text());
    }
    for(let i = 0; i < text_url_ary_2.length; i++){
        const response = await fetch(text_url_ary_2[i]);
        this.textContent_ary_2.push(await response.text());
    }
    if(this.textContent_ary_1.length !== this.textContent_ary_2.length){
        console.error('textContent_ary_1とtextContent_ary_2のlengthが異なります');
    }

    this.set_data_sample_array_obj(0);
},

// sample_array_objからIDX指定してsample_array_objのdata_0とdata_1をtextareaに格納する関数
set_data_sample_array_obj(IDX){
    if(this.text_attacher(IDX) === true){
        this.exe1();
        return;
    }
    this.data_a = this.textContent_ary_1[IDX];
    this.data_b = this.textContent_ary_2[IDX];
    this.exe1();
},



async save_data_to_all_save(){
    try {
    const item_key = this.data_type;
    this.all_save.push(to_ary([this.data_a, this.data_b]));
    await localforage.setItem(item_key, JSON.stringify(this.all_save));
    } catch (error) {
        console.log(error);
    };
},
async save_data_load() {
    try {
    const item_key = this.data_type;
    this.all_save = JSON.parse(await localforage.getItem(item_key)) || [];
    } catch (error) {
        console.log(error);
    }
},
async save_data_delete(INDEX){
    try {
    const item_key = this.data_type;
    if (window.confirm("Do you really want to delete??🦖\n本当に削除する？?🦕\n" + R.zip(this.all_save[INDEX][0].split("\n"), this.all_save[INDEX][1].split("\n")).join("\n") )) {
        this.all_save.splice(INDEX, 1);
        await localforage.setItem(item_key, JSON.stringify(this.all_save));
    };
    } catch (error) {
        console.log(error);
    }
},

save_data_set(INDEX){
    this.data_a = this.all_save[INDEX][0];
    this.data_b = this.all_save[INDEX][1];
},


fn9(IDX){
    console.log("fn9");
this.data_a = this.online_data_A[IDX][0];
this.data_b = this.online_data_A[IDX][1];
},
reverse_q_a(){
    console.log("reverse_q_a");
this.data_a = this.data_a.split("\n").reverse().join("\n");
this.data_b = this.data_b.split("\n").reverse().join("\n");
},
shuffle_q_a(){
shuffled_data = R.transpose(shuffle(R.zip(
    this.data_a.split("\n"),
    this.data_b.split("\n")
)));
this.data_a = shuffled_data[0].join("\n");
this.data_b = shuffled_data[1].join("\n");
},
swap_q_a(){
[tmp0, tmp1] = [this.data_a, this.data_b];
[this.data_a, this.data_b] = [tmp1, tmp0];
},
fn16(INDEX){
this.online_data_A.splice(INDEX, 1);
},
fn18(){
    const RESULTS = this.$refs.results;
        RESULTS.map(ELM=>ELM.style.display).some(DISPLAY=>DISPLAY==='block' || DISPLAY==='') ?
            RESULTS.map(ELM=>ELM.style.display = 'none') :
            RESULTS.map(ELM=>ELM.style.display = 'block');
},
fn19_0(){
    const THE_STYLE_DISPLAY1 = this.$refs.save_data_set_list_parent1.style.display;
    this.$refs.save_data_set_list_parent1.style.display = (THE_STYLE_DISPLAY1 === 'block' || THE_STYLE_DISPLAY1 === '') ? 'none' : 'block';
},
fn19_1(){
    const THE_STYLE_DISPLAY2 = this.$refs.save_data_set_list_parent2.style.display;
    this.$refs.save_data_set_list_parent2.style.display = (THE_STYLE_DISPLAY2 === 'block' || THE_STYLE_DISPLAY2 === '') ? 'none' : 'block';
},











q_a_fn2_1() {
return this.split_data_b.map((V, IDX)=>{
    return shuffle(shuffle(R.without(this.split_data_b[IDX], this.split_data_b)).slice(0, 2).concat(this.split_data_b[IDX]));
});
},
q_a_fn2_2() {
return R.zip(this.split_data_b, this.q_a_fn2_1()).map((V,IDX)=>[
                                                                    V[0],
                                                                    V[1],
                                                                    this.data_a.split("\n")[IDX],
                                                                    '',
                                                                ]);
},
q_a_processing() {
// this.split_data_b = this.data_b.split("\n");
// this.hoge_ary = this.q_a_fn2_2();
// this.exe1();
// this.hoge_ary = convertData2ToData1(to_ary(app.exe1_data));
},
convertData2ToData1(data2){
    shuffled_data1_ary = shuffle(data2.map(V=>V[1]));
    data2_1 = data2.map(V=>V[1]);
    const without_same_str_data1_ary = (same_str) => data2_1.filter(V=> V !== same_str);
    // return without_same_str_data1_ary(data2_1[0]);
    this.hoge_ary = data2.map(item => [
        item[1],
        shuffle(
            shuffle(without_same_str_data1_ary(item[1])).slice(0, 2).concat(item[1])
        ),
        item[0],
        ""
    ]);

    // return data2_1;
},
async q_a_fn3(correct, answer) {
    console.log('q_a_fn3', correct, answer);
    this.hoge_ary[this.only_one_q_a_mode_COUNTER][3] = answer === correct ? "⭕️" : "❎";
    const done_result = async () => {
            // this.paint_result = '全問完了';
            // 待機
            await new Promise(resolve => setTimeout(resolve, this.time_interval * 1000));
            // this.paint_result = '';
    };
    // this.hoge_ary初期化
    // const init_data = () => this.hoge_ary = this.q_a_fn2_2();
    const init_data = () => this.convertData2ToData1(to_ary(app.exe1_data));
    if(this.hoge_ary[this.only_one_q_a_mode_COUNTER][3] === '⭕️'){
        console.log("maru");
        await done_result();
        this.only_one_q_a_mode_COUNTER++;
        this.hoge_ary.length - 1 === this.only_one_q_a_mode_COUNTER
            ?
            (this.only_one_q_a_mode_COUNTER = 0, init_data()) :
            null;
    }
},
q_a_test_index(Test_index) {
this.hoge_ary.forEach((V,IDX)=>this.q_a_fn3(V[0], V[1][Test_index], IDX));
this.q_a_fn4();
},
// q_a_change_current_index(ONE_UP_OR_ONE_DOWN=1) {
//     this.current_index = this.current_index + (ONE_UP_OR_ONE_DOWN);
//     this.current_index < 0 ? this.current_index = this.hoge_ary.length - 1 : null;
//     this.current_index > this.hoge_ary.length - 1 ? this.current_index = 0 : null;
// },
q_a_fn20(INDEX){
this.q_a_data5[INDEX] = null;
},


// core of q_a



auto_slide(){
    this.auto_slide_mode = true;
    setInterval(() => {
        this.next_slide();
        // 0.5であれば1000倍して500msごとにスライドを進める
    }, this.time_interval * 1000);
},
stop_auto_slide(){
    this.auto_slide_mode = false;
    // 全てのsetIntervalを停止する
    for (let i = 1; i < 99999; i++) window.clearInterval(i);
},
// 最初へ戻す関数
first_slide(){
    this.currentIndex = 0;
},
prev_slide(){
    if (this.currentIndex > 0) {
        this.currentIndex--;
    } else {
        this.currentIndex = this.slides.length - 1;
    }
},
next_slide(){
    if (this.currentIndex < this.slides.length - 1) {
        this.currentIndex++;
    } else {
        this.currentIndex = 0;
    }
},
async change_paint_or_raw(RAW_IDX){
    // 全問完了したらn秒全問完了と表示する関数
    const done_result = async () => {
        this.paint_result = '全問完了';
        // 待機
        await new Promise(resolve => setTimeout(resolve, this.time_interval * 1000));
        this.paint_result = '';
    };


    const waitAndExecute = async () => {
        this.exe1_data[this.only_one_q_a_mode_COUNTER][4] = false;
        // 待機
        await new Promise(resolve => setTimeout(resolve, this.time_interval * 1000));
        console.log("n秒経過しました");
        this.exe1_data[this.only_one_q_a_mode_COUNTER].length - 1 === this.only_one_q_a_mode_COUNTER
            ?
            this.only_one_q_a_mode_COUNTER = 0 :
            this.only_one_q_a_mode_COUNTER++;
            // 全て実行したら[4]を全てtrueにする
        this.exe1_data[this.only_one_q_a_mode_COUNTER].length - 1 === this.only_one_q_a_mode_COUNTER
            ?
            this.exe1_data.forEach((val, idx) => val[4] = true) :
            null;
        console.log(this.exe1_data[this.only_one_q_a_mode_COUNTER]);
    }
    await waitAndExecute();
    if(this.exe1_data[this.only_one_q_a_mode_COUNTER].length - 1 === this.only_one_q_a_mode_COUNTER){
        await done_result();
    }
},
exe1(Param_Str){
    let data_0_ary = this.data_a.split('\n');
    let data_1_ary = this.data_b.split('\n');
    const res = data_0_ary.map((val, idx) => {
        return {
            data_0: val,
            data_1: data_1_ary[idx],
        };
    });
    d1 = res;
    d2 = d1.map((val, idx) => val.data_1 );
    d3 = d2.map((val, idx) => {
        const filter_d2 = d2.filter((val2, idx2) => val2 !== d2[idx]);
        const only_filter_data = shuffle(filter_d2)[0];
        const ok_or_ng_answer_str_ary = shuffle([d2[idx], only_filter_data]);
        const data_0 = d1[idx].data_0;
        return [data_0, val, ok_or_ng_answer_str_ary, false, true];
    });
    this.exe1_data = d3;
    if(Param_Str === "reverse"){
        console.log("reverse");
        this.exe1_data = R.reverse(to_ary(this.exe1_data));
    }
    if(Param_Str === "shuffle"){
        console.log("shuffle");
        this.exe1_data = shuffle(to_ary(this.exe1_data));
    }

    this.slides = this.make_slide(this.exe1_data);
    // this.q_a_processing();
},
make_slide(Ary_Param){
    function flattenAndExtract(ary) {
        let res = [];
        ary.forEach((val, idx) => {
            res.push({q: val[0]});
            res.push({a: val[1]});
        });
        return res;
    }
    return flattenAndExtract(Ary_Param);
},
text_attacher(IDX){
    if(this.textContent_ary_1){
        this.data_a = this.textContent_ary_1[IDX];
        this.data_b = this.textContent_ary_2[IDX];
        return true;
    }
},
// sample_array_objからIDX指定してsample_array_objのdata_0とdata_1をtextareaに格納する関数
set_data_sample_array_obj(IDX){
    if(this.text_attacher(IDX) === true){
        this.exe1();
        return;
    }
    this.data_a = this.textContent_ary_1[IDX];
    this.data_b = this.textContent_ary_2[IDX];
    this.exe1();
},
async check_maru_batu(VAL, RESULT, Maru_Or_Batu){
    // 不正解のボタンを押した時に正解の問題が一瞬点灯する処理の関数
        const maru = this.$refs.maru;
        const batu = this.$refs.batu;

    console.log(VAL);
    console.log(RESULT);
    // n秒だけmaru_batu_resultに全問完了と表示する関数
    const waitAndExecute = async () => {
        this.maru_batu_result = '全問完了';
        // 待機
        await new Promise(resolve => setTimeout(resolve, this.time_interval * 1000));
        this.maru_batu_result = '';
    }
if(this.exe1_data[this.only_one_q_a_mode_COUNTER].length - 1 === this.only_one_q_a_mode_COUNTER){
    await waitAndExecute()
};


    if(VAL[1] === RESULT){
        console.log('正解');
        VAL[3] = true;
        // 正解の場合は次の問題に進む
        this.exe1_data[this.only_one_q_a_mode_COUNTER].length - 1 === this.only_one_q_a_mode_COUNTER
            ?
            (this.only_one_q_a_mode_COUNTER = 0, this.exe1_data.forEach(V=>V[3] = false)) :
            this.only_one_q_a_mode_COUNTER++;


        this.flash_incorrect = '';
    }else{
        console.log('不正解');
        VAL[3] = false;
        this.flash_incorrect = Maru_Or_Batu === 'maru' ? 'batu' : 'maru';
    }

},




toggle_sidebar() {
    this.column_1_none = !this.column_1_none;
},



textarea_opener() {
    this.textarea_visible = !this.textarea_visible;
},





show_qr(){
    new QRCode(this.$refs.qrcode, {
        text: "https://taroyanaka.github.io/q_a/b_p.html",
        width: 256,
        height: 256,
        colorDark : "#000000",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.H
    });
},



},
}).mount('.app');

function to_ary(it){
    return JSON.parse(JSON.stringify(it));
};
// div.column-2とfixed_element以外を非表示にする
// document.querySelectorAll('body :not(.fixed_element)').forEach(V=>V.style.display='none');





</script>
</html>