<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>black paint q_a</title>
<link rel="stylesheet" href="./lib/reset.css">
<script src="./lib/vue@3.2.36.global.prod.js"></script>
<script src="./lib/shuffle.js"></script>
<!-- optional_function ‚Üí opFnchoose_question ‚Üí chQnparent_choose ‚Üí paChchoose_button ‚Üí chBtchoose_button_num0 ‚Üí chBt0choose_button_num1 ‚Üí chBt1choose_button_num2 ‚Üí chBt2prgr_bar ‚Üí prBrtoggle_sidebar ‚Üí tgSbcolumn-2-when-display-toggle_sidebar ‚Üí co2TgSflash_incorrect ‚Üí flIccolumn-1 ‚Üí co1column-2 ‚Üí co2column-2-when-display-none-column-1 ‚Üí co2D1display-none-column-1 ‚Üí dnCo1slide_mode_color ‚Üí slMcblack-paint-it ‚Üí bpItmaru_batu ‚Üí mrBtparent_full_screen ‚Üí paFSfront_of_full_screen ‚Üí frFSback_full_screen ‚Üí baFSusername ‚Üí uNam-->
<style>
button{white-space:wrap;overflow:visible}
.uNam{width:90%}
.opFn button{font-size:2rem}
.chQn{font-size:5rem}
.paCh{display:flex;flex-direction:column;height:50vh;justify-content:space-around}
.chBt{font-size:4rem;white-space:wrap;overflow:visible}
.chBt0,.chBt1,.chBt2{display:flex;justify-content:center;width:100%;height:33%}
.prBr{height:.7rem;width:calc(100% - 12rem);position:fixed;bottom:0;left:0}
.tgSb{position:fixed;bottom:0;right:0;width:10rem;height:3rem}
.co2TgS{z-index:20;position:fixed;top:0;right:0;width:10rem;height:3rem}
@keyframes flash{0%{opacity:1}50%{opacity:0}100%{opacity:1}}
.flIc{animation:flash 1s 1}
.co1{position:fixed;top:0;left:0;width:5rem;height:100vh;background:#f1f1f1;z-index:100}
.co2{position:relative;top:0;left:5rem;width:calc(100% - 5rem);height:100vh;background:gray;z-index:1}
.co2D1{position:relative;top:0;left:0;width:100%;height:100vh;background:gray;z-index:1}
.dnCo1{display:none;width:0;height:0}
.slMc{background:#DDFFDD}
.q{text-align:left}
.a{text-align:right}
.bpIt{color:#000;background:#000}
.mrBt,.mrBt*,.blPt,.slMc{font-size:10vw;white-space:word-wrap}
.paFS{position:relative}
.frFS{z-index:10;position:absolute;top:0}
.baFS{z-index:1;position:absolute;top:0;width:100%;display:flex;justify-content:space-around}
.maru,.batu{justify-content:center;width:50%;height:50vh}
.chBt{white-space:normal;padding:.5rem}
</style>
</head>
<body class="app">
<div :class="co1Non?'dnCo1':'co1'">
  <button @click="chMode('choose')">ÈÅ∏Êäû„É¢„Éº„Éâ</button>
  <button @click="chMode('maru_batu')">‚≠ïÔ∏è‚ùéÂïèÈ°å„É¢„Éº„Éâ</button>
  <button @click="chMode('black_paint')">ÈªíÂ°ó„Çä„É¢„Éº„Éâ</button>
  <button @click="chMode('slide')">„Çπ„É©„Ç§„Éâ„É¢„Éº„Éâ</button>
  <button @click="chMode('qr')">QR„Ç≥„Éº„Éâ</button>
  <div class="opFn">
    <button @click="ex1('reverse')">üîÉ</button>
    <button @click="ex1('shuffle')">üå™Ô∏è</button>
    <button @click="ex1('swap')">üîÅ</button>
    <button @click="rdShre">üìù</button>
  </div>
  <div v-if="wbDat.message">
    <input type="text" v-model="usrNam" class="uNam">
    <ul style="display:block" ref="save_data_set_list_parent1">
      <li v-for="(d,i) in usWDat">
        <button @click="stDaWD(i)">
          {{ JSON.parse(d.data_json_str).data1.split('\n')[0].slice(0,5) }}
        </button>
      </li>
    </ul>
  </div>
  <p>version 0.0.1.4</p>
</div>
<div :class="co1Non?'co2D1':'co2'">
  <div>
    <button @click="tgSide" :class="co1Non?'tgSb':'co2TgS'">Toggle Sidebar</button>
    <!-- „Éá„Éê„ÉÉ„Ç∞Áî®: ÁèæÂú®„ÅÆÂïèÈ°å„Éá„Éº„Çø„ÇíÂá∫Âäõ -->
    <template v-for="dv in ex1Dat"><div>{{ dv }}</div></template>

    <!-- ÈÅ∏Êäû„É¢„Éº„Éâ -->
    <div v-if="md==='choose'">
      <template v-for="dv in [ex1Dat[ooQAMC]]">
        <div class="paCh">
          <span class="chQn">{{ dv[0] }} {{ dv[5] }}</span>
          <button v-for="(item,ix) in dv[2]" :class="'chBt chBt'+ix" @click="chQACh(dv[1], item)">
            {{ trText(item) }}
          </button>
        </div>
      </template>
    </div>

    <!-- „Åæ„Çã„Å∞„Å§„É¢„Éº„Éâ -->
    <div v-if="md==='maru_batu'" class="mrBt">
      <template v-for="dv in [ex1Dat[ooQAMC]]">
        <progress :value="ooQAMC" :max="ex1Dat.length" class="prBr"></progress>
        <div v-if="dv[3]===false" class="paFS">
          <div class="frFS">
            <span>{{ dv[0] }}</span><span> = </span><span>{{ dv[2][0] }}</span>
            <div v-if="mbRslt!==''">{{ mbRslt }}</div>
          </div>
          <div class="baFS">
            <button @click="chMaBa(dv,dv[2][0],'maru')" :class="flInco==='maru'||flInco===null?'flIc maru':'maru'">‚≠ïÔ∏è</button>
            <button @click="chMaBa(dv,dv[2][1],'batu')" :class="flInco==='batu'||flInco===null?'flIc batu':'batu'">‚ùé</button>
          </div>
        </div>
      </template>
    </div>

    <!-- ÈªíÂ°ó„Çä„É¢„Éº„Éâ -->
    <div v-if="md==='black_paint'" class="blPt" @click="chPaRw">
      <template v-for="dv in [ex1Dat[ooQAMC]]">
        <progress :value="ooQAMC" :max="ex1Dat[ooQAMC].length" class="prBr"></progress>
        <div>{{ dv[0] }}</div>
        <div :class="dv[4]?'bpIt':''">{{ dv[1] }}</div>
        <div v-if="paRslt!==''">{{ paRslt }}</div>
      </template>
    </div>

    <!-- „Çπ„É©„Ç§„Éâ„É¢„Éº„Éâ -->
    <div v-if="md==='slide'" class="slMc">
      <progress :value="curIdx" :max="sldes.length" class="prBr"></progress><br><br>
      <div v-if="sldes.length>0">
        <div v-if="sldes[curIdx].q" class="q" @click="nxSlid">{{ sldes[curIdx].q }}</div>
        <div v-if="sldes[curIdx].a" class="a" @click="nxSlid">{{ sldes[curIdx].a }}</div>
      </div>
      <button @click="frSlid">ÊúÄÂàù„Å∏</button>
      <button @click="prSlid">Ââç„Å∏</button>
      <button @click="nxSlid">Ê¨°„Å∏</button>
      <div v-if="!auSlMd">
        <button @click="auSlid">auto slide</button>
        <input type="number" v-model="tmIntv" min="0.1" step="0.1">Áßí
      </div>
      <div v-if="auSlMd"><button @click="stAuSl">stop auto slide</button></div>
    </div>

    <!-- QRË°®Á§∫„É¢„Éº„Éâ -->
    <div v-if="md==='qr'">
      <button @click="shQr">show_qr</button>
      <div ref="qrcode"></div>
    </div>
  </div>
</div>
<script>
const app=Vue.createApp({
data(){return{
  trTeLn:20,usWDat:[],usrNam:'user1',
  shUsr:'',shTag:'',shOrBy:'DESC',
  enpnt:'https://cotton-concrete-catsup.glitch.me',wbDat:[],
  paRslt:'',mbRslt:'',flInco:'',
  ooQAMD:true,ooQAMC:0,co1Non:true,
  sldes:[],curIdx:0,auSlMd:false,tmIntv:.5,md:'choose',
  dtA:`„Åì„Çì„Å´„Å°„ÅØ\n„ÇÑ„ÅÇ\n„ÅÑ„ÅÑ\n„ÅØ„ÅÑ\nÁä¨\nÁå´\nÈ£ü‰∫ã\nÁú†„Çä`,
  dtB:`hello\nhi\ngood\nyes\ndog\ncat\nfood\nsleep`,
  ex1Dat:[["„Åì„Çì„Å´„Å°„ÅØ","hello",["food","hello"],false,true,""]]
}},
watch:{
  usrNam(){this.gtUsWD()},
  shUsr(){this.ftRdAl()},shTag(){this.ftRdAl()},shOrBy(){this.ftRdAl()}
},
async mounted(){
  this.ex1();
  await this.ftRdAl();
},
methods:{
  trText(t){return t.length>this.trTeLn?t.slice(0,this.trTeLn)+'...':t},
  stDaWD(i){
    if(confirm('Really??')){
      let j=JSON.parse(this.usWDat[i].data_json_str);
      this.dtA=j.data1;this.dtB=j.data2;this.ex1();
    }
  },
  gtUsWD(){this.usWDat=toAry(this.wbDat.message).filter(v=>v.username===this.usrNam)},
  async ftRdAl(){
    try{
      let p={user:this.shUsr,tag:this.shTag,order_by:this.shOrBy},
          u=new URL(this.enpnt+'/read_all');
      u.search=new URLSearchParams(p).toString();
      let r=await fetch(u,{method:'GET',headers:{'Content-Type':'application/json'}});
      this.wbDat=await r.json();this.gtUsWD();
    }catch(e){
      this.ooQAMC=0;
      this.ex1Dat=[["„Åì„Çì„Å´„Å°„ÅØ","hello(or any error)",["food","hello"],false,true,""]];
      this.ex1();
    }
  },
  chMode(m){this.ooQAMC=0;this.md=m;this.ex1()},
  ex1(p){
    this.ooQAMC=0;
    let[a,b]=p==='swap'
      ?[this.dtB.split('\n'),this.dtA.split('\n')]
      :[this.dtA.split('\n'),this.dtB.split('\n')];
    let f=(d0,d1)=>d0.map((v,i)=>[v,d1[i],shuffle([d1[i],shuffle(d1.filter((_,x)=>x!==i))[0]]),false,true,'']);
    this.ex1Dat=f(a,b);
    if(p==="reverse")this.ex1Dat=R.reverse(toAry(this.ex1Dat));
    if(p==="shuffle")this.ex1Dat=shuffle(toAry(this.ex1Dat));
    this.sldes=this.mkSlid(this.ex1Dat);
  },
  chQACh(c,a){
    let d=this.ex1Dat[this.ooQAMC];
    d[5]=(a===c)?'‚≠ïÔ∏è':'‚ùé';
    const fn=()=>{
      this.ooQAMC++;
      this.ooQAMC===this.ex1Dat.length?(this.ooQAMC=0,this.ex1Dat.forEach(x=>x[5]='')):null;
    };
    d[5]==='‚≠ïÔ∏è'?setTimeout(fn,this.tmIntv*1000):null;
  },
  async chMaBa(v,r,m){
    const fn=()=>{
      this.ooQAMC++;
      this.ooQAMC===this.ex1Dat.length?(this.ooQAMC=0,this.ex1Dat.forEach(x=>x[3]=false)):null;
    };
    const cmpl=async()=>{
      this.mbRslt='ÂÖ®ÂïèÂÆå‰∫Ü';
      await new Promise(rs=>setTimeout(rs,this.tmIntv*1000));
      this.mbRslt='';
    };
    v[1]===r?(v[3]=true,fn(),this.flInco=''):(v[3]=false,this.flInco=(m==='maru'?'batu':'maru'));
    this.ooQAMC===this.ex1Dat.length-1?await cmpl():null;
  },
  mkSlid(a){return a.flatMap(v=>[{q:v[0]},{a:v[1]}])},
  async chPaRw(){
    let d=this.ex1Dat[this.ooQAMC];
    const rs=async()=>{
      this.ex1Dat.forEach(x=>x[4]=true);
      this.ooQAMC=0;
    };
    const cmpl=async()=>{
      this.paRslt='ÂÖ®ÂïèÂÆå‰∫Ü';
      await new Promise(r=>setTimeout(r,this.tmIntv*1000));
      this.paRslt='';rs();
    };
    d?(d[4]=false,await new Promise(r=>setTimeout(r,this.tmIntv*1000)),this.ooQAMC++):rs();
    this.ex1Dat[this.ooQAMC]?.length-1===this.ooQAMC?await cmpl():null;
  },
  frSlid(){this.curIdx=0},
  prSlid(){this.curIdx>0?this.curIdx--:this.curIdx=this.sldes.length-1},
  nxSlid(){this.curIdx<this.sldes.length-1?this.curIdx++:this.curIdx=0},
  auSlid(){this.auSlMd=true;setInterval(()=>{this.nxSlid()},this.tmIntv*1000)},
  stAuSl(){this.auSlMd=false;for(let i=1;i<99999;i++)clearInterval(i)},
  rdShre(){if(confirm('Leave this page?'))location.href='./share.html'},
  tgSide(){this.co1Non=!this.co1Non},
  shQr(){new QRCode(this.$refs.qrcode,{text:"https://taroyanaka.github.io/q_a/b_p.html",width:256,height:256,colorDark:"#000",colorLight:"#fff",correctLevel:QRCode.CorrectLevel.H})}
}
}).mount('.app');
function toAry(i){return JSON.parse(JSON.stringify(i))}
</script>
</body>
</html>
